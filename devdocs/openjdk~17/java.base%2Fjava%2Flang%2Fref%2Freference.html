<h1 title="Class Reference" class="title">Class Reference&lt;T&gt;</h1> <div class="inheritance" title="Inheritance Tree">
<a href="../object" title="class in java.lang">java.lang.Object</a> <div class="inheritance">java.lang.ref.Reference&lt;T&gt;</div> </div> <section class="class-description" id="class-description"> <dl class="notes"> <dt>Direct Known Subclasses:</dt> <dd>
<code><a href="phantomreference" title="class in java.lang.ref">PhantomReference</a></code>, <code><a href="softreference" title="class in java.lang.ref">SoftReference</a></code>, <code><a href="weakreference" title="class in java.lang.ref">WeakReference</a></code>
</dd> </dl>  <pre class="lang-java" data-language="java">public abstract class Reference&lt;T&gt; extends Object</pre> <div class="block">Abstract base class for reference objects. This class defines the operations common to all reference objects. Because reference objects are implemented in close cooperation with the garbage collector, this class may not be subclassed directly.</div> <dl class="notes"> <dt>Since:</dt> <dd>1.2</dd> </dl> </section> <section class="summary"> <section class="method-summary" id="method-summary"> <h2>Method Summary</h2> <div id="method-summary-table">  <div id="method-summary-table.tabpanel" role="tabpanel"> <table class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">                         <tr>
<th>Modifier and Type</th>
<th>Method</th>
<th>Description</th>
</tr>
<tr>
<td><code>void</code></td>
<td><code><a href="#clear()" class="member-name-link">clear</a>()</code></td>
<td> <div class="block">Clears this reference object.</div> </td>
</tr>
<tr>
<td><code>protected <a href="../object" title="class in java.lang">Object</a></code></td>
<td><code><a href="#clone()" class="member-name-link">clone</a>()</code></td>
<td> <div class="block">Throws <a href="../clonenotsupportedexception" title="class in java.lang"><code>CloneNotSupportedException</code></a>.</div> </td>
</tr>
<tr>
<td><code>boolean</code></td>
<td><code><a href="#enqueue()" class="member-name-link">enqueue</a>()</code></td>
<td> <div class="block">Clears this reference object and adds it to the queue with which it is registered, if any.</div> </td>
</tr>
<tr>
<td><code><a href="reference" title="type parameter in Reference">T</a></code></td>
<td><code><a href="#get()" class="member-name-link">get</a>()</code></td>
<td> <div class="block">Returns this reference object's referent.</div> </td>
</tr>
<tr>
<td><code>boolean</code></td>
<td><code><a href="#isEnqueued()" class="member-name-link">isEnqueued</a>()</code></td>
<td> <div class="block">
<span class="deprecated-label">Deprecated.</span> <div class="deprecation-comment">This method was originally specified to test if a reference object has been cleared and enqueued but was never implemented to do this test.</div> </div> </td>
</tr>
<tr>
<td><code>static void</code></td>
<td><code><a href="#reachabilityFence(java.lang.Object)" class="member-name-link">reachabilityFence</a><wbr>(<a href="../object" title="class in java.lang">Object</a> ref)</wbr></code></td>
<td> <div class="block">Ensures that the object referenced by the given reference remains <a href="package-summary#reachability"><em>strongly reachable</em></a>, regardless of any prior actions of the program that might otherwise cause the object to become unreachable; thus, the referenced object is not reclaimable by garbage collection at least until after the invocation of this method.</div> </td>
</tr>
<tr>
<td><code>final boolean</code></td>
<td><code><a href="#refersTo(T)" class="member-name-link">refersTo</a><wbr>(<a href="reference" title="type parameter in Reference">T</a> obj)</wbr></code></td>
<td> <div class="block">Tests if the referent of this reference object is <code>obj</code>.</div> </td>
</tr>
</table> </div> </div> <div class="inherited-list"> <h3 id="methods-inherited-from-class-java.lang.Object">Methods declared in class java.lang.<a href="../object" title="class in java.lang">Object</a>
</h3> <code><a href="../object#equals(java.lang.Object)">equals</a>, <a href="../object#finalize()">finalize</a>, <a href="../object#getClass()">getClass</a>, <a href="../object#hashCode()">hashCode</a>, <a href="../object#notify()">notify</a>, <a href="../object#notifyAll()">notifyAll</a>, <a href="../object#toString()">toString</a>, <a href="../object#wait()">wait</a>, <a href="../object#wait(long)">wait</a>, <a href="../object#wait(long,int)">wait</a></code>
</div> </section> </section> <section class="details"> <section class="method-details" id="method-detail"> <h2>Method Details</h2>  </section><section class="detail" id="get()"> <h3>get</h3> <pre class="lang-java" data-language="java">public T get()</pre> <div class="block">Returns this reference object's referent. If this reference object has been cleared, either by the program or by the garbage collector, then this method returns <code>null</code>.</div> <dl class="notes"> <dt>API Note:</dt> <dd>This method returns a strong reference to the referent. This may cause the garbage collector to treat it as strongly reachable until some later collection cycle. The <a href="#refersTo(T)"><code>refersTo</code></a> method can be used to avoid such strengthening when testing whether some object is the referent of a reference object; that is, use <code>ref.refersTo(obj)</code> rather than <code>ref.get() == obj</code>.</dd> <dt>Returns:</dt> <dd>The object to which this reference refers, or <code>null</code> if this reference object has been cleared</dd> <dt>See Also:</dt> <dd> <ul class="see-list"> <li><a href="#refersTo(T)"><code>refersTo(T)</code></a></li> </ul> </dd> </dl> </section><section class="detail" id="refersTo(T)"> <h3 id="refersTo(java.lang.Object)">refersTo</h3> <pre class="lang-java" data-language="java">public final boolean refersTo(T obj)</pre> <div class="block">Tests if the referent of this reference object is <code>obj</code>. Using a <code>null</code> <code>obj</code> returns <code>true</code> if the reference object has been cleared.</div> <dl class="notes"> <dt>Parameters:</dt> <dd>
<code>obj</code> - the object to compare with this reference object's referent</dd> <dt>Returns:</dt> <dd>
<code>true</code> if <code>obj</code> is the referent of this reference object</dd> <dt>Since:</dt> <dd>16</dd> </dl> </section><section class="detail" id="clear()"> <h3>clear</h3> <pre class="lang-java" data-language="java">public void clear()</pre> <div class="block">Clears this reference object. Invoking this method will not cause this object to be enqueued. <p> This method is invoked only by Java code; when the garbage collector clears references it does so directly, without invoking this method.</p>
</div> </section><section class="detail" id="isEnqueued()"> <h3>isEnqueued</h3> <pre class="lang-java" data-language="java">@Deprecated(since="16") public boolean isEnqueued()</pre> <div class="deprecation-block">
<span class="deprecated-label">Deprecated.</span> <div class="deprecation-comment">This method was originally specified to test if a reference object has been cleared and enqueued but was never implemented to do this test. This method could be misused due to the inherent race condition or without an associated <code>ReferenceQueue</code>. An application relying on this method to release critical resources could cause serious performance issue. An application should use <a href="referencequeue" title="class in java.lang.ref"><code>ReferenceQueue</code></a> to reliably determine what reference objects that have been enqueued or <a href="#refersTo(T)"><code>refersTo(null)</code></a> to determine if this reference object has been cleared.</div> </div> <div class="block">Tests if this reference object is in its associated queue, if any. This method returns <code>true</code> only if all of the following conditions are met: <ul> <li>this reference object was registered with a queue when it was created; and </li>
<li>the garbage collector has added this reference object to the queue or <a href="#enqueue()"><code>enqueue()</code></a> is called; and </li>
<li>this reference object is not yet removed from the queue. </li>
</ul> Otherwise, this method returns <code>false</code>. This method may return <code>false</code> if this reference object has been cleared but not enqueued due to the race condition.</div> <dl class="notes"> <dt>Returns:</dt> <dd>
<code>true</code> if and only if this reference object is in its associated queue (if any).</dd> </dl> </section><section class="detail" id="enqueue()"> <h3>enqueue</h3> <pre class="lang-java" data-language="java">public boolean enqueue()</pre> <div class="block">Clears this reference object and adds it to the queue with which it is registered, if any. <p> This method is invoked only by Java code; when the garbage collector enqueues references it does so directly, without invoking this method.</p>
</div> <dl class="notes"> <dt>Returns:</dt> <dd>
<code>true</code> if this reference object was successfully enqueued; <code>false</code> if it was already enqueued or if it was not registered with a queue when it was created</dd> </dl> </section><section class="detail" id="clone()"> <h3>clone</h3> <pre class="lang-java" data-language="java">protected Object clone() throws CloneNotSupportedException</pre> <div class="block">Throws <a href="../clonenotsupportedexception" title="class in java.lang"><code>CloneNotSupportedException</code></a>. A <code>Reference</code> cannot be meaningfully cloned. Construct a new <code>Reference</code> instead.</div> <dl class="notes"> <dt>Overrides:</dt> <dd>
<code><a href="../object#clone()">clone</a></code> in class <code><a href="../object" title="class in java.lang">Object</a></code>
</dd> <dt>Returns:</dt> <dd>never returns normally</dd> <dt>Throws:</dt> <dd>
<code><a href="../clonenotsupportedexception" title="class in java.lang">CloneNotSupportedException</a></code> - always</dd> <dt>Since:</dt> <dd>11</dd> <dt>See Also:</dt> <dd> <ul class="see-list"> <li><a href="../cloneable" title="interface in java.lang"><code>Cloneable</code></a></li> </ul> </dd> </dl> </section><section class="detail" id="reachabilityFence(java.lang.Object)"> <h3>reachabilityFence</h3> <pre class="lang-java" data-language="java">public static void reachabilityFence(Object ref)</pre> <div class="block">Ensures that the object referenced by the given reference remains <a href="package-summary#reachability"><em>strongly reachable</em></a>, regardless of any prior actions of the program that might otherwise cause the object to become unreachable; thus, the referenced object is not reclaimable by garbage collection at least until after the invocation of this method. Invocation of this method does not itself initiate garbage collection or finalization. <p> This method establishes an ordering for <a href="package-summary#reachability"><em>strong reachability</em></a> with respect to garbage collection. It controls relations that are otherwise only implicit in a program -- the reachability conditions triggering garbage collection. This method is designed for use in uncommon situations of premature finalization where using <code>synchronized</code> blocks or methods, or using other synchronization facilities are not possible or do not provide the desired control. This method is applicable only when reclamation may have visible effects, which is possible for objects with finalizers (See Section <a href="https://docs.oracle.com/javase/specs/jls/se17/html/jls-12.html#jls-12.6">12.6</a> of <cite>The Java Language Specification</cite>) that are implemented in ways that rely on ordering control for correctness.</p>
</div> <dl class="notes"> <dt>API Note:</dt> <dd>Finalization may occur whenever the virtual machine detects that no reference to an object will ever be stored in the heap: The garbage collector may reclaim an object even if the fields of that object are still in use, so long as the object has otherwise become unreachable. This may have surprising and undesirable effects in cases such as the following example in which the bookkeeping associated with a class is managed through array indices. Here, method <code>action</code> uses a <code>reachabilityFence</code> to ensure that the <code>Resource</code> object is not reclaimed before bookkeeping on an associated <code>ExternalResource</code> has been performed; in particular here, to ensure that the array slot holding the <code>ExternalResource</code> is not nulled out in method <a href="../object#finalize()"><code>Object.finalize()</code></a>, which may otherwise run concurrently. <pre class="lang-java" data-language="java"> <code>
 class Resource {
   private static ExternalResource[] externalResourceArray = ...

   int myIndex;
   Resource(...) {
     myIndex = ...
     externalResourceArray[myIndex] = ...;
     ...
   }
   protected void finalize() {
     externalResourceArray[myIndex] = null;
     ...
   }
   public void action() {
     try {
       // ...
       int i = myIndex;
       Resource.update(externalResourceArray[i]);
     } finally {
       Reference.reachabilityFence(this);
     }
   }
   private static void update(ExternalResource ext) {
     ext.status = ...;
   }
 }</code></pre> Here, the invocation of <code>reachabilityFence</code> is nonintuitively placed <em>after</em> the call to <code>update</code>, to ensure that the array slot is not nulled out by <a href="../object#finalize()"><code>Object.finalize()</code></a> before the update, even if the call to <code>action</code> was the last use of this object. This might be the case if, for example a usage in a user program had the form <code>new Resource().action();</code> which retains no other reference to this <code>Resource</code>. While probably overkill here, <code>reachabilityFence</code> is placed in a <code>finally</code> block to ensure that it is invoked across all paths in the method. In a method with more complex control paths, you might need further precautions to ensure that <code>reachabilityFence</code> is encountered along all of them. <p> It is sometimes possible to better encapsulate use of <code>reachabilityFence</code>. Continuing the above example, if it were acceptable for the call to method <code>update</code> to proceed even if the finalizer had already executed (nulling out slot), then you could localize use of <code>reachabilityFence</code>: </p>
<pre class="lang-java" data-language="java"> <code>
 public void action2() {
   // ...
   Resource.update(getExternalResource());
 }
 private ExternalResource getExternalResource() {
   ExternalResource ext = externalResourceArray[myIndex];
   Reference.reachabilityFence(this);
   return ext;
 }</code></pre> <p> Method <code>reachabilityFence</code> is not required in constructions that themselves ensure reachability. For example, because objects that are locked cannot, in general, be reclaimed, it would suffice if all accesses of the object, in all methods of class <code>Resource</code> (including <code>finalize</code>) were enclosed in <code>synchronized (this)</code> blocks. (Further, such blocks must not include infinite loops, or themselves be unreachable, which fall into the corner case exceptions to the "in general" disclaimer.) However, method <code>reachabilityFence</code> remains a better option in cases where this approach is not as efficient, desirable, or possible; for example because it would encounter deadlock.</p>
</dd> <dt>Parameters:</dt> <dd>
<code>ref</code> - the reference. If <code>null</code>, this method has no effect.</dd> <dt>See <i>Java Language Specification</i>:</dt> <dd> <a href="https://docs.oracle.com/javase/specs/jls/se17/html/jls-12.html#jls-12.6">12.6 Finalization of Class Instances</a><br>
</dd> <dt>Since:</dt> <dd>9</dd> </dl> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 1993, 2021, Oracle and/or its affiliates. All rights reserved.<br>Documentation extracted from Debian's OpenJDK Development Kit package.<br>Licensed under the GNU General Public License, version 2, with the Classpath Exception.<br>Various third party code in OpenJDK is licensed under different licenses (see Debian package).<br>Java and OpenJDK are trademarks or registered trademarks of Oracle and/or its affiliates.<br>
    <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/ref/Reference.html" class="_attribution-link">https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/ref/Reference.html</a>
  </p>
</div>
