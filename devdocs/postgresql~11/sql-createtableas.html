<h1>CREATE TABLE AS</h1> <p>CREATE TABLE AS â€” define a new table from the results of a query</p>   <h2>Synopsis</h2> <pre data-language="sql">
CREATE [ [ GLOBAL | LOCAL ] { TEMPORARY | TEMP } | UNLOGGED ] TABLE [ IF NOT EXISTS ] table_name
    [ (column_name [, ...] ) ]
    [ WITH ( storage_parameter [= value] [, ... ] ) | WITH OIDS | WITHOUT OIDS ]
    [ ON COMMIT { PRESERVE ROWS | DELETE ROWS | DROP } ]
    [ TABLESPACE tablespace_name ]
    AS query
    [ WITH [ NO ] DATA ]
</pre>  <div class="refsect1" id="id-1.9.3.86.5"> <h2>Description</h2> <p><code class="command">CREATE TABLE AS</code> creates a table and fills it with data computed by a <code class="command">SELECT</code> command. The table columns have the names and data types associated with the output columns of the <code class="command">SELECT</code> (except that you can override the column names by giving an explicit list of new column names).</p> <p><code class="command">CREATE TABLE AS</code> bears some resemblance to creating a view, but it is really quite different: it creates a new table and evaluates the query just once to fill the new table initially. The new table will not track subsequent changes to the source tables of the query. In contrast, a view re-evaluates its defining <code class="command">SELECT</code> statement whenever it is queried.</p> </div> <div class="refsect1" id="id-1.9.3.86.6"> <h2>Parameters</h2> <div class="variablelist"> <dl class="variablelist"> <dt>
<code class="literal">GLOBAL</code> or <code class="literal">LOCAL</code>
</dt> <dd> <p>Ignored for compatibility. Use of these keywords is deprecated; refer to <a class="xref" href="sql-createtable" title="CREATE TABLE">CREATE TABLE</a> for details.</p> </dd> </dl> </div> <div class="variablelist"> <dl class="variablelist"> <dt>
<code class="literal">TEMPORARY</code> or <code class="literal">TEMP</code>
</dt> <dd> <p>If specified, the table is created as a temporary table. Refer to <a class="xref" href="sql-createtable" title="CREATE TABLE">CREATE TABLE</a> for details.</p> </dd> <dt><code class="literal">UNLOGGED</code></dt> <dd> <p>If specified, the table is created as an unlogged table. Refer to <a class="xref" href="sql-createtable" title="CREATE TABLE">CREATE TABLE</a> for details.</p> </dd> <dt><code class="literal">IF NOT EXISTS</code></dt> <dd> <p>Do not throw an error if a relation with the same name already exists. A notice is issued in this case. Refer to <a class="xref" href="sql-createtable" title="CREATE TABLE">CREATE TABLE</a> for details.</p> </dd> <dt><code>table_name</code></dt> <dd> <p>The name (optionally schema-qualified) of the table to be created.</p> </dd> <dt><code>column_name</code></dt> <dd> <p>The name of a column in the new table. If column names are not provided, they are taken from the output column names of the query.</p> </dd> <dt><code class="literal">WITH ( storage_parameter [= value] [, ... ] )</code></dt> <dd> <p>This clause specifies optional storage parameters for the new table; see <a class="xref" href="sql-createtable#SQL-CREATETABLE-STORAGE-PARAMETERS" title="Storage Parameters">Storage Parameters</a> for more information. The <code class="literal">WITH</code> clause can also include <code class="literal">OIDS=TRUE</code> (or just <code class="literal">OIDS</code>) to specify that rows of the new table should have OIDs (object identifiers) assigned to them, or <code class="literal">OIDS=FALSE</code> to specify that the rows should not have OIDs. See <a class="xref" href="sql-createtable" title="CREATE TABLE">CREATE TABLE</a> for more information.</p> </dd> <dt>
<code class="literal">WITH OIDS</code><code class="literal">WITHOUT OIDS</code>
</dt> <dd> <p>These are obsolescent syntaxes equivalent to <code class="literal">WITH (OIDS)</code> and <code class="literal">WITH (OIDS=FALSE)</code>, respectively. If you wish to give both an <code class="literal">OIDS</code> setting and storage parameters, you must use the <code class="literal">WITH ( ... )</code> syntax; see above.</p> </dd> <dt><code class="literal">ON COMMIT</code></dt> <dd> <p>The behavior of temporary tables at the end of a transaction block can be controlled using <code class="literal">ON COMMIT</code>. The three options are:</p> <div class="variablelist"> <dl class="variablelist"> <dt><code class="literal">PRESERVE ROWS</code></dt> <dd> <p>No special action is taken at the ends of transactions. This is the default behavior.</p> </dd> <dt><code class="literal">DELETE ROWS</code></dt> <dd> <p>All rows in the temporary table will be deleted at the end of each transaction block. Essentially, an automatic <a class="xref" href="sql-truncate" title="TRUNCATE">TRUNCATE</a> is done at each commit.</p> </dd> <dt><code class="literal">DROP</code></dt> <dd> <p>The temporary table will be dropped at the end of the current transaction block.</p> </dd> </dl> </div> </dd> <dt><code class="literal">TABLESPACE tablespace_name</code></dt> <dd> <p>The <code>tablespace_name</code> is the name of the tablespace in which the new table is to be created. If not specified, <a class="xref" href="runtime-config-client#GUC-DEFAULT-TABLESPACE">default_tablespace</a> is consulted, or <a class="xref" href="runtime-config-client#GUC-TEMP-TABLESPACES">temp_tablespaces</a> if the table is temporary.</p> </dd> <dt><code>query</code></dt> <dd> <p>A <a class="xref" href="sql-select" title="SELECT">SELECT</a>, <a class="link" href="sql-select#SQL-TABLE" title="TABLE Command">TABLE</a>, or <a class="xref" href="sql-values" title="VALUES">VALUES</a> command, or an <a class="xref" href="sql-execute" title="EXECUTE">EXECUTE</a> command that runs a prepared <code class="command">SELECT</code>, <code class="command">TABLE</code>, or <code class="command">VALUES</code> query.</p> </dd> <dt><code class="literal">WITH [ NO ] DATA</code></dt> <dd> <p>This clause specifies whether or not the data produced by the query should be copied into the new table. If not, only the table structure is copied. The default is to copy the data.</p> </dd> </dl> </div> </div> <div class="refsect1" id="id-1.9.3.86.7"> <h2>Notes</h2> <p>This command is functionally similar to <a class="xref" href="sql-selectinto" title="SELECT INTO">SELECT INTO</a>, but it is preferred since it is less likely to be confused with other uses of the <code class="command">SELECT INTO</code> syntax. Furthermore, <code class="command">CREATE TABLE AS</code> offers a superset of the functionality offered by <code class="command">SELECT INTO</code>.</p> <p>The <code class="command">CREATE TABLE AS</code> command allows the user to explicitly specify whether OIDs should be included. If the presence of OIDs is not explicitly specified, the <a class="xref" href="runtime-config-compatible#GUC-DEFAULT-WITH-OIDS">default_with_oids</a> configuration variable is used.</p> </div> <div class="refsect1" id="id-1.9.3.86.8"> <h2>Examples</h2> <p>Create a new table <code class="literal">films_recent</code> consisting of only recent entries from the table <code class="literal">films</code>:</p> <pre data-language="sql">
CREATE TABLE films_recent AS
  SELECT * FROM films WHERE date_prod &gt;= '2002-01-01';
</pre> <p>To copy a table completely, the short form using the <code class="literal">TABLE</code> command can also be used:</p> <pre data-language="sql">
CREATE TABLE films2 AS
  TABLE films;
</pre> <p>Create a new temporary table <code class="literal">films_recent</code>, consisting of only recent entries from the table <code class="literal">films</code>, using a prepared statement. The new table has OIDs and will be dropped at commit:</p> <pre data-language="sql">
PREPARE recentfilms(date) AS
  SELECT * FROM films WHERE date_prod &gt; $1;
CREATE TEMP TABLE films_recent WITH (OIDS) ON COMMIT DROP AS
  EXECUTE recentfilms('2002-01-01');
</pre> </div> <div class="refsect1" id="id-1.9.3.86.9"> <h2>Compatibility</h2> <p><code class="command">CREATE TABLE AS</code> conforms to the SQL standard. The following are nonstandard extensions:</p>  <ul> <li> <p>The standard requires parentheses around the subquery clause; in PostgreSQL, these parentheses are optional.</p> </li> <li> <p>In the standard, the <code class="literal">WITH [ NO ] DATA</code> clause is required; in PostgreSQL it is optional.</p> </li> <li> <p>PostgreSQL handles temporary tables in a way rather different from the standard; see <a class="xref" href="sql-createtable" title="CREATE TABLE">CREATE TABLE</a> for details.</p> </li> <li> <p>The <code class="literal">WITH</code> clause is a PostgreSQL extension; neither storage parameters nor OIDs are in the standard.</p> </li> <li> <p>The PostgreSQL concept of tablespaces is not part of the standard. Hence, the clause <code class="literal">TABLESPACE</code> is an extension.</p> </li> </ul>  </div> <div class="refsect1" id="id-1.9.3.86.10"> <h2>See Also</h2>
<span class="simplelist"><a class="xref" href="sql-creatematerializedview" title="CREATE MATERIALIZED VIEW">CREATE MATERIALIZED VIEW</a>, <a class="xref" href="sql-createtable" title="CREATE TABLE">CREATE TABLE</a>, <a class="xref" href="sql-execute" title="EXECUTE">EXECUTE</a>, <a class="xref" href="sql-select" title="SELECT">SELECT</a>, <a class="xref" href="sql-selectinto" title="SELECT INTO">SELECT INTO</a>, <a class="xref" href="sql-values" title="VALUES">VALUES</a></span> </div>  <div class="navfooter">  <table summary="Navigation footer"> <tr> <td width="40%" align="left">
<a accesskey="p" href="sql-createtable">Prev</a> </td> <td width="20%" align="center"><a accesskey="u" href="https://www.postgresql.org/docs/11/sql-commands.html">Up</a></td> <td width="40%" align="right"> <a accesskey="n" href="sql-createtablespace">Next</a>
</td> </tr> <tr> <td width="40%" align="left">CREATE TABLE </td> <td width="20%" align="center"><a accesskey="h" href="https://www.postgresql.org/docs/11/index.html">Home</a></td> <td width="40%" align="right"> CREATE TABLESPACE</td> </tr> </table> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 1996&ndash;2019 The PostgreSQL Global Development Group<br>Licensed under the PostgreSQL License.<br>
    <a href="https://www.postgresql.org/docs/11/sql-createtableas.html" class="_attribution-link">https://www.postgresql.org/docs/11/sql-createtableas.html</a>
  </p>
</div>
