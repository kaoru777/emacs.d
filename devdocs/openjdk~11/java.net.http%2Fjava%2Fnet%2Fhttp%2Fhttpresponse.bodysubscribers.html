  <main role="main">    <h1>Class HttpResponse.BodySubscribers</h1>   <ul class="inheritance"> <li><a href="../../../../java.base/java/lang/object">java.lang.Object</a></li> <li> <ul class="inheritance"> <li>java.net.http.HttpResponse.BodySubscribers</li> </ul> </li> </ul>   <dl> <dt>Enclosing interface:</dt> <dd>
<a href="httpresponse">HttpResponse</a>&lt;<a href="httpresponse">T</a>&gt;</dd> </dl>  <pre data-language="java">public static class HttpResponse.BodySubscribers
extends Object</pre> <div>
<p>Implementations of <a href="httpresponse.bodysubscriber"><code>BodySubscriber</code></a> that implement various useful subscribers, such as converting the response body bytes into a String, or streaming the bytes to a file. </p>
<p>The following are examples of using the predefined body subscribers to convert a flow of response body data into common high-level Java objects: </p>
<pre data-language="java">// Streams the response body to a File
   HttpResponse&lt;byte[]&gt; response = client
     .send(request, responseInfo -&gt; BodySubscribers.ofByteArray());

   // Accumulates the response body and returns it as a byte[]
   HttpResponse&lt;byte[]&gt; response = client
     .send(request, responseInfo -&gt; BodySubscribers.ofByteArray());

   // Discards the response body
   HttpResponse&lt;Void&gt; response = client
     .send(request, responseInfo -&gt; BodySubscribers.discarding());

   // Accumulates the response body as a String then maps it to its bytes
   HttpResponse&lt;byte[]&gt; response = client
     .send(request, responseInfo -&gt;
        BodySubscribers.mapping(BodySubscribers.ofString(UTF_8), String::getBytes));</pre>
</div> <dl> <dt>Since:</dt> <dd>11</dd> </dl>      <section role="region">  <h2 id="method.summary">Methods</h2> <table>  <tr> <th scope="col">Modifier and Type</th> <th scope="col">Method</th> <th scope="col">Description</th> </tr> <tr id="i0"> <td><code>static &lt;T&gt; <a href="httpresponse.bodysubscriber">HttpResponse.BodySubscriber</a>&lt;T&gt;</code></td> <th scope="row"><code><a href="#buffering(java.net.http.HttpResponse.BodySubscriber,int)">buffering</a>​(<a href="httpresponse.bodysubscriber">HttpResponse.BodySubscriber</a>&lt;T&gt; downstream,
         int bufferSize)</code></th> <td> <p>Returns a <code>BodySubscriber</code> which buffers data before delivering it to the given downstream subscriber.</p> </td> </tr> <tr id="i1"> <td><code>static <a href="httpresponse.bodysubscriber">HttpResponse.BodySubscriber</a>&lt;<a href="../../../../java.base/java/lang/void">Void</a>&gt;</code></td> <th scope="row"><code><a href="#discarding()">discarding</a>()</code></th> <td> <p>Returns a response subscriber which discards the response body.</p> </td> </tr> <tr id="i2"> <td><code>static <a href="httpresponse.bodysubscriber">HttpResponse.BodySubscriber</a>&lt;<a href="../../../../java.base/java/lang/void">Void</a>&gt;</code></td> <th scope="row"><code><a href="#fromLineSubscriber(java.util.concurrent.Flow.Subscriber)">fromLineSubscriber</a>​(<a href="../../../../java.base/java/util/concurrent/flow.subscriber">Flow.Subscriber</a>&lt;? super <a href="../../../../java.base/java/lang/string">String</a>&gt; subscriber)</code></th> <td> <p>Returns a body subscriber that forwards all response body to the given <code>Flow.Subscriber</code>, line by line.</p> </td> </tr> <tr id="i3"> <td><code>static &lt;S extends <a href="../../../../java.base/java/util/concurrent/flow.subscriber">Flow.Subscriber</a>&lt;? super <a href="../../../../java.base/java/lang/string">String</a>&gt;,​T&gt;<br><a href="httpresponse.bodysubscriber">HttpResponse.BodySubscriber</a>&lt;T&gt;</code></td> <th scope="row"><code><a href="#fromLineSubscriber(S,java.util.function.Function,java.nio.charset.Charset,java.lang.String)">fromLineSubscriber</a>​(S subscriber,
                  <a href="../../../../java.base/java/util/function/function">Function</a>&lt;? super S,​? extends T&gt; finisher,
                  <a href="../../../../java.base/java/nio/charset/charset">Charset</a> charset,
                  <a href="../../../../java.base/java/lang/string">String</a> lineSeparator)</code></th> <td> <p>Returns a body subscriber that forwards all response body to the given <code>Flow.Subscriber</code>, line by line.</p> </td> </tr> <tr id="i4"> <td><code>static <a href="httpresponse.bodysubscriber">HttpResponse.BodySubscriber</a>&lt;<a href="../../../../java.base/java/lang/void">Void</a>&gt;</code></td> <th scope="row"><code><a href="#fromSubscriber(java.util.concurrent.Flow.Subscriber)">fromSubscriber</a>​(<a href="../../../../java.base/java/util/concurrent/flow.subscriber">Flow.Subscriber</a>&lt;? super <a href="../../../../java.base/java/util/list">List</a>&lt;<a href="../../../../java.base/java/nio/bytebuffer">ByteBuffer</a>&gt;&gt; subscriber)</code></th> <td> <p>Returns a body subscriber that forwards all response body to the given <code>Flow.Subscriber</code>.</p> </td> </tr> <tr id="i5"> <td><code>static &lt;S extends <a href="../../../../java.base/java/util/concurrent/flow.subscriber">Flow.Subscriber</a>&lt;? super <a href="../../../../java.base/java/util/list">List</a>&lt;<a href="../../../../java.base/java/nio/bytebuffer">ByteBuffer</a>&gt;&gt;,​T&gt;<br><a href="httpresponse.bodysubscriber">HttpResponse.BodySubscriber</a>&lt;T&gt;</code></td> <th scope="row"><code><a href="#fromSubscriber(S,java.util.function.Function)">fromSubscriber</a>​(S subscriber,
              <a href="../../../../java.base/java/util/function/function">Function</a>&lt;? super S,​? extends T&gt; finisher)</code></th> <td> <p>Returns a body subscriber that forwards all response body to the given <code>Flow.Subscriber</code>.</p> </td> </tr> <tr id="i6"> <td><code>static &lt;T,​U&gt;<br><a href="httpresponse.bodysubscriber">HttpResponse.BodySubscriber</a>&lt;U&gt;</code></td> <th scope="row"><code><a href="#mapping(java.net.http.HttpResponse.BodySubscriber,java.util.function.Function)">mapping</a>​(<a href="httpresponse.bodysubscriber">HttpResponse.BodySubscriber</a>&lt;T&gt; upstream,
       <a href="../../../../java.base/java/util/function/function">Function</a>&lt;? super T,​? extends U&gt; mapper)</code></th> <td> <p>Returns a <code>BodySubscriber</code> whose response body value is that of the result of applying the given function to the body object of the given <code>upstream</code> <code>BodySubscriber</code>.</p> </td> </tr> <tr id="i7"> <td><code>static <a href="httpresponse.bodysubscriber">HttpResponse.BodySubscriber</a>&lt;byte[]&gt;</code></td> <th scope="row"><code><a href="#ofByteArray()">ofByteArray</a>()</code></th> <td> <p>Returns a <code>BodySubscriber</code> which stores the response body as a byte array.</p> </td> </tr> <tr id="i8"> <td><code>static <a href="httpresponse.bodysubscriber">HttpResponse.BodySubscriber</a>&lt;<a href="../../../../java.base/java/lang/void">Void</a>&gt;</code></td> <th scope="row"><code><a href="#ofByteArrayConsumer(java.util.function.Consumer)">ofByteArrayConsumer</a>​(<a href="../../../../java.base/java/util/function/consumer">Consumer</a>&lt;<a href="../../../../java.base/java/util/optional">Optional</a>&lt;byte[]&gt;&gt; consumer)</code></th> <td> <p>Returns a <code>BodySubscriber</code> which provides the incoming body data to the provided Consumer of <code>Optional&lt;byte[]&gt;</code>.</p> </td> </tr> <tr id="i9"> <td><code>static <a href="httpresponse.bodysubscriber">HttpResponse.BodySubscriber</a>&lt;<a href="../../../../java.base/java/nio/file/path">Path</a>&gt;</code></td> <th scope="row"><code><a href="#ofFile(java.nio.file.Path)">ofFile</a>​(<a href="../../../../java.base/java/nio/file/path">Path</a> file)</code></th> <td> <p>Returns a <code>BodySubscriber</code> which stores the response body in a file opened with the given name.</p> </td> </tr> <tr id="i10"> <td><code>static <a href="httpresponse.bodysubscriber">HttpResponse.BodySubscriber</a>&lt;<a href="../../../../java.base/java/nio/file/path">Path</a>&gt;</code></td> <th scope="row"><code><a href="#ofFile(java.nio.file.Path,java.nio.file.OpenOption...)">ofFile</a>​(<a href="../../../../java.base/java/nio/file/path">Path</a> file,
      <a href="../../../../java.base/java/nio/file/openoption">OpenOption</a>... openOptions)</code></th> <td> <p>Returns a <code>BodySubscriber</code> which stores the response body in a file opened with the given options and name.</p> </td> </tr> <tr id="i11"> <td><code>static <a href="httpresponse.bodysubscriber">HttpResponse.BodySubscriber</a>&lt;<a href="../../../../java.base/java/io/inputstream">InputStream</a>&gt;</code></td> <th scope="row"><code><a href="#ofInputStream()">ofInputStream</a>()</code></th> <td> <p>Returns a <code>BodySubscriber</code> which streams the response body as an <a href="../../../../java.base/java/io/inputstream"><code>InputStream</code></a>.</p> </td> </tr> <tr id="i12"> <td><code>static <a href="httpresponse.bodysubscriber">HttpResponse.BodySubscriber</a>&lt;<a href="../../../../java.base/java/util/stream/stream">Stream</a>&lt;<a href="../../../../java.base/java/lang/string">String</a>&gt;&gt;</code></td> <th scope="row"><code><a href="#ofLines(java.nio.charset.Charset)">ofLines</a>​(<a href="../../../../java.base/java/nio/charset/charset">Charset</a> charset)</code></th> <td> <p>Returns a <code>BodySubscriber</code> which streams the response body as a <a href="../../../../java.base/java/util/stream/stream"><code>Stream</code></a>, where each string in the stream corresponds to a line as defined by <a href="../../../../java.base/java/io/bufferedreader#lines()"><code>BufferedReader.lines()</code></a>.</p> </td> </tr> <tr id="i13"> <td><code>static <a href="httpresponse.bodysubscriber">HttpResponse.BodySubscriber</a>&lt;<a href="../../../../java.base/java/util/concurrent/flow.publisher">Flow.Publisher</a>&lt;<a href="../../../../java.base/java/util/list">List</a>&lt;<a href="../../../../java.base/java/nio/bytebuffer">ByteBuffer</a>&gt;&gt;&gt;</code></td> <th scope="row"><code><a href="#ofPublisher()">ofPublisher</a>()</code></th> <td> <p>Returns a response subscriber which publishes the response body through a <code>Publisher&lt;List&lt;ByteBuffer&gt;&gt;</code>.</p> </td> </tr> <tr id="i14"> <td><code>static <a href="httpresponse.bodysubscriber">HttpResponse.BodySubscriber</a>&lt;<a href="../../../../java.base/java/lang/string">String</a>&gt;</code></td> <th scope="row"><code><a href="#ofString(java.nio.charset.Charset)">ofString</a>​(<a href="../../../../java.base/java/nio/charset/charset">Charset</a> charset)</code></th> <td> <p>Returns a body subscriber which stores the response body as a <code>
 String</code> converted using the given <code>Charset</code>.</p> </td> </tr> <tr id="i15"> <td><code>static &lt;U&gt; <a href="httpresponse.bodysubscriber">HttpResponse.BodySubscriber</a>&lt;U&gt;</code></td> <th scope="row"><code><a href="#replacing(U)">replacing</a>​(U value)</code></th> <td> <p>Returns a response subscriber which discards the response body.</p> </td> </tr> </table>  <h2 id="methods.inherited.from.class.java.lang.Object">Methods declared in class java.lang.<a href="../../../../java.base/java/lang/object">Object</a>
</h2> <code><a href="../../../../java.base/java/lang/object#clone()">clone</a>, <a href="../../../../java.base/java/lang/object#equals(java.lang.Object)">equals</a>, <a href="../../../../java.base/java/lang/object#finalize()">finalize</a>, <a href="../../../../java.base/java/lang/object#getClass()">getClass</a>, <a href="../../../../java.base/java/lang/object#hashCode()">hashCode</a>, <a href="../../../../java.base/java/lang/object#notify()">notify</a>, <a href="../../../../java.base/java/lang/object#notifyAll()">notifyAll</a>, <a href="../../../../java.base/java/lang/object#toString()">toString</a>, <a href="../../../../java.base/java/lang/object#wait()">wait</a>, <a href="../../../../java.base/java/lang/object#wait(long)">wait</a>, <a href="../../../../java.base/java/lang/object#wait(long,int)">wait</a></code>  </section>   <div>   <section role="region">  <h2 id="method.detail">Methods</h2>   <h3 id="fromSubscriber(java.util.concurrent.Flow.Subscriber)">fromSubscriber</h3> <pre data-language="java">public static HttpResponse.BodySubscriber&lt;Void&gt; fromSubscriber(Flow.Subscriber&lt;? super List&lt;ByteBuffer&gt;&gt; subscriber)</pre> <p>Returns a body subscriber that forwards all response body to the given <code>Flow.Subscriber</code>. The <a href="httpresponse.bodysubscriber#getBody()">completion stage</a> of the returned body subscriber completes after one of the given subscribers <code>onComplete</code> or <code>onError</code> has been invoked.</p> <dl> <dt>API Note:</dt> <dd>This method can be used as an adapter between <code>
 BodySubscriber</code> and <code>Flow.Subscriber</code>.</dd> <dt>Parameters:</dt> <dd>
<code>subscriber</code> - the subscriber</dd> <dt>Returns:</dt> <dd>a body subscriber</dd> </dl>    <h3 id="fromSubscriber(java.util.concurrent.Flow.Subscriber,java.util.function.Function)">fromSubscriber</h3> <pre data-language="java">public static &lt;S extends Flow.Subscriber&lt;? super List&lt;ByteBuffer&gt;&gt;,T&gt; HttpResponse.BodySubscriber&lt;T&gt; fromSubscriber​(S subscriber,
                                                                                                                          Function&lt;? super S,​? extends T&gt; finisher)</pre> <div>
<p>Returns a body subscriber that forwards all response body to the given <code>Flow.Subscriber</code>. The <a href="httpresponse.bodysubscriber#getBody()">completion stage</a> of the returned body subscriber completes after one of the given subscribers <code>onComplete</code> or <code>onError</code> has been invoked. </p>
<p> The given <code>finisher</code> function is applied after the given subscriber's <code>onComplete</code> has been invoked. The <code>finisher</code> function is invoked with the given subscriber, and returns a value that is set as the response's body.</p>
</div> <dl> <dt>API Note:</dt> <dd>This method can be used as an adapter between <code>
 BodySubscriber</code> and <code>Flow.Subscriber</code>.</dd> <dt>Type Parameters:</dt> <dd>
<code>S</code> - the type of the Subscriber</dd> <dd>
<code>T</code> - the type of the response body</dd> <dt>Parameters:</dt> <dd>
<code>subscriber</code> - the subscriber</dd> <dd>
<code>finisher</code> - a function to be applied after the subscriber has completed</dd> <dt>Returns:</dt> <dd>a body subscriber</dd> </dl>    <h3 id="fromLineSubscriber(java.util.concurrent.Flow.Subscriber)">fromLineSubscriber</h3> <pre data-language="java">public static HttpResponse.BodySubscriber&lt;Void&gt; fromLineSubscriber(Flow.Subscriber&lt;? super String&gt; subscriber)</pre> <p>Returns a body subscriber that forwards all response body to the given <code>Flow.Subscriber</code>, line by line. The <a href="httpresponse.bodysubscriber#getBody()">completion stage</a> of the returned body subscriber completes after one of the given subscribers <code>onComplete</code> or <code>onError</code> has been invoked. Bytes are decoded using the <a href="../../../../java.base/java/nio/charset/standardcharsets#UTF_8"><code>UTF-8</code></a> charset, and lines are delimited in the manner of <a href="../../../../java.base/java/io/bufferedreader#readLine()"><code>BufferedReader.readLine()</code></a>.</p> <dl> <dt>API Note:</dt> <dd>This method can be used as an adapter between <code>
 BodySubscriber</code> and <code>Flow.Subscriber</code>.</dd> <dt>Implementation Note:</dt> <dd>This is equivalent to calling <pre data-language="java">fromLineSubscriber(subscriber, s -&gt; null, StandardCharsets.UTF_8, null)</pre>
</dd> <dt>Parameters:</dt> <dd>
<code>subscriber</code> - the subscriber</dd> <dt>Returns:</dt> <dd>a body subscriber</dd> </dl>    <h3 id="fromLineSubscriber(java.util.concurrent.Flow.Subscriber,java.util.function.Function,java.nio.charset.Charset,java.lang.String)">fromLineSubscriber</h3> <pre data-language="java">public static &lt;S extends Flow.Subscriber&lt;? super String&gt;,T&gt; HttpResponse.BodySubscriber&lt;T&gt; fromLineSubscriber​(S subscriber,
                                                                                                                    Function&lt;? super S,​? extends T&gt; finisher,
                                                                                                                    Charset charset,
                                                                                                                    String lineSeparator)</pre> <div>
<p>Returns a body subscriber that forwards all response body to the given <code>Flow.Subscriber</code>, line by line. The <a href="httpresponse.bodysubscriber#getBody()">completion stage</a> of the returned body subscriber completes after one of the given subscribers <code>onComplete</code> or <code>onError</code> has been invoked. </p>
<p> The given <code>finisher</code> function is applied after the given subscriber's <code>onComplete</code> has been invoked. The <code>finisher</code> function is invoked with the given subscriber, and returns a value that is set as the response's body.</p>
</div> <dl> <dt>API Note:</dt> <dd>This method can be used as an adapter between <code>
 BodySubscriber</code> and <code>Flow.Subscriber</code>.</dd> <dt>Type Parameters:</dt> <dd>
<code>S</code> - the type of the Subscriber</dd> <dd>
<code>T</code> - the type of the response body</dd> <dt>Parameters:</dt> <dd>
<code>subscriber</code> - the subscriber</dd> <dd>
<code>finisher</code> - a function to be applied after the subscriber has completed</dd> <dd>
<code>charset</code> - a <a href="../../../../java.base/java/nio/charset/charset"><code>Charset</code></a> to decode the bytes</dd> <dd>
<code>lineSeparator</code> - an optional line separator: can be <code>null</code>, in which case lines will be delimited in the manner of <a href="../../../../java.base/java/io/bufferedreader#readLine()"><code>BufferedReader.readLine()</code></a>.</dd> <dt>Returns:</dt> <dd>a body subscriber</dd> <dt>Throws:</dt> <dd>
<code><a href="../../../../java.base/java/lang/illegalargumentexception">IllegalArgumentException</a></code> - if the supplied <code>lineSeparator</code> is the empty string</dd> </dl>    <h3 id="ofString(java.nio.charset.Charset)">ofString</h3> <pre data-language="java">public static HttpResponse.BodySubscriber&lt;String&gt; ofString(Charset charset)</pre> <div>
<p>Returns a body subscriber which stores the response body as a <code>
 String</code> converted using the given <code>Charset</code>. </p>
<p> The <a href="httpresponse"><code>HttpResponse</code></a> using this subscriber is available after the entire response has been read.</p>
</div> <dl> <dt>Parameters:</dt> <dd>
<code>charset</code> - the character set to convert the String with</dd> <dt>Returns:</dt> <dd>a body subscriber</dd> </dl>    <h3 id="ofByteArray()">ofByteArray</h3> <pre data-language="java">public static HttpResponse.BodySubscriber&lt;byte[]&gt; ofByteArray()</pre> <div>
<p>Returns a <code>BodySubscriber</code> which stores the response body as a byte array. </p>
<p> The <a href="httpresponse"><code>HttpResponse</code></a> using this subscriber is available after the entire response has been read.</p>
</div> <dl> <dt>Returns:</dt> <dd>a body subscriber</dd> </dl>    <h3 id="ofFile(java.nio.file.Path,java.nio.file.OpenOption...)">ofFile</h3> <pre data-language="java">public static HttpResponse.BodySubscriber&lt;Path&gt; ofFile(Path file,
                                                       OpenOption... openOptions)</pre> <div>
<p>Returns a <code>BodySubscriber</code> which stores the response body in a file opened with the given options and name. The file will be opened with the given options using <a href="../../../../java.base/java/nio/channels/filechannel#open(java.nio.file.Path,java.nio.file.OpenOption...)"><code>FileChannel.open</code></a> just before the body is read. Any exception thrown will be returned or thrown from <a href="httpclient#send(java.net.http.HttpRequest,java.net.http.HttpResponse.BodyHandler)"><code>HttpClient::send</code></a> or <a href="httpclient#sendAsync(java.net.http.HttpRequest,java.net.http.HttpResponse.BodyHandler)"><code>HttpClient::sendAsync</code></a> as appropriate. </p>
<p> The <a href="httpresponse"><code>HttpResponse</code></a> using this subscriber is available after the entire response has been read. </p>
<p> Security manager permission checks are performed in this factory method, when the <code>BodySubscriber</code> is created. Care must be taken that the <code>BodyHandler</code> is not shared with untrusted code.</p>
</div> <dl> <dt>Parameters:</dt> <dd>
<code>file</code> - the file to store the body in</dd> <dd>
<code>openOptions</code> - the list of options to open the file with</dd> <dt>Returns:</dt> <dd>a body subscriber</dd> <dt>Throws:</dt> <dd>
<code><a href="../../../../java.base/java/lang/illegalargumentexception">IllegalArgumentException</a></code> - if an invalid set of open options are specified</dd> <dd>
<code><a href="../../../../java.base/java/lang/securityexception">SecurityException</a></code> - if a security manager has been installed and it denies <a href="../../../../java.base/java/lang/securitymanager#checkWrite(java.lang.String)"><code>write access</code></a> to the file</dd> </dl>    <h3 id="ofFile(java.nio.file.Path)">ofFile</h3> <pre data-language="java">public static HttpResponse.BodySubscriber&lt;Path&gt; ofFile(Path file)</pre> <div>
<p>Returns a <code>BodySubscriber</code> which stores the response body in a file opened with the given name. </p>
<p> Equivalent to: <code>ofFile(file, CREATE, WRITE)</code> </p>
<p> Security manager permission checks are performed in this factory method, when the <code>BodySubscriber</code> is created. Care must be taken that the <code>BodyHandler</code> is not shared with untrusted code.</p>
</div> <dl> <dt>Parameters:</dt> <dd>
<code>file</code> - the file to store the body in</dd> <dt>Returns:</dt> <dd>a body subscriber</dd> <dt>Throws:</dt> <dd>
<code><a href="../../../../java.base/java/lang/securityexception">SecurityException</a></code> - if a security manager has been installed and it denies <a href="../../../../java.base/java/lang/securitymanager#checkWrite(java.lang.String)"><code>write access</code></a> to the file</dd> </dl>    <h3 id="ofByteArrayConsumer(java.util.function.Consumer)">ofByteArrayConsumer</h3> <pre data-language="java">public static HttpResponse.BodySubscriber&lt;Void&gt; ofByteArrayConsumer(Consumer&lt;Optional&lt;byte[]&gt;&gt; consumer)</pre> <div>
<p>Returns a <code>BodySubscriber</code> which provides the incoming body data to the provided Consumer of <code>Optional&lt;byte[]&gt;</code>. Each call to <a href="../../../../java.base/java/util/function/consumer#accept(T)"><code>Consumer.accept()</code></a> will contain a non empty <code>Optional</code>, except for the final invocation after all body data has been read, when the <code>
 Optional</code> will be empty. </p>
<p> The <a href="httpresponse"><code>HttpResponse</code></a> using this subscriber is available after the entire response has been read.</p>
</div> <dl> <dt>API Note:</dt> <dd>This subscriber is not flow controlled. Therefore, the supplied consumer must be able to process whatever amount of data is delivered in a timely fashion.</dd> <dt>Parameters:</dt> <dd>
<code>consumer</code> - a Consumer of byte arrays</dd> <dt>Returns:</dt> <dd>a BodySubscriber</dd> </dl>    <h3 id="ofInputStream()">ofInputStream</h3> <pre data-language="java">public static HttpResponse.BodySubscriber&lt;InputStream&gt; ofInputStream()</pre> <div>
<p>Returns a <code>BodySubscriber</code> which streams the response body as an <a href="../../../../java.base/java/io/inputstream"><code>InputStream</code></a>. </p>
<p> The <a href="httpresponse"><code>HttpResponse</code></a> using this subscriber is available immediately after the response headers have been read, without requiring to wait for the entire body to be processed. The response body can then be read directly from the <a href="../../../../java.base/java/io/inputstream"><code>InputStream</code></a>.</p>
</div> <dl> <dt>API Note:</dt> <dd>To ensure that all resources associated with the corresponding exchange are properly released the caller must ensure to either read all bytes until EOF is reached, or call <a href="../../../../java.base/java/io/inputstream#close()"><code>InputStream.close()</code></a> if it is unable or unwilling to do so. Calling <code>close</code> before exhausting the stream may cause the underlying HTTP connection to be closed and prevent it from being reused for subsequent operations.</dd> <dt>Returns:</dt> <dd>a body subscriber that streams the response body as an <a href="../../../../java.base/java/io/inputstream"><code>InputStream</code></a>.</dd> </dl>    <h3 id="ofLines(java.nio.charset.Charset)">ofLines</h3> <pre data-language="java">public static HttpResponse.BodySubscriber&lt;Stream&lt;String&gt;&gt; ofLines(Charset charset)</pre> <div>
<p>Returns a <code>BodySubscriber</code> which streams the response body as a <a href="../../../../java.base/java/util/stream/stream"><code>Stream</code></a>, where each string in the stream corresponds to a line as defined by <a href="../../../../java.base/java/io/bufferedreader#lines()"><code>BufferedReader.lines()</code></a>. </p>
<p> The <a href="httpresponse"><code>HttpResponse</code></a> using this subscriber is available immediately after the response headers have been read, without requiring to wait for the entire body to be processed. The response body can then be read directly from the <a href="../../../../java.base/java/util/stream/stream"><code>Stream</code></a>.</p>
</div> <dl> <dt>API Note:</dt> <dd>To ensure that all resources associated with the corresponding exchange are properly released the caller must ensure to either read all lines until the stream is exhausted, or call <a href="../../../../java.base/java/util/stream/basestream#close()"><code>BaseStream.close()</code></a> if it is unable or unwilling to do so. Calling <code>close</code> before exhausting the stream may cause the underlying HTTP connection to be closed and prevent it from being reused for subsequent operations.</dd> <dt>Parameters:</dt> <dd>
<code>charset</code> - the character set to use when converting bytes to characters</dd> <dt>Returns:</dt> <dd>a body subscriber that streams the response body as a <a href="../../../../java.base/java/util/stream/stream"><code>Stream</code></a>.</dd> <dt>See Also:</dt> <dd><a href="../../../../java.base/java/io/bufferedreader#lines()"><code>BufferedReader.lines()</code></a></dd> </dl>    <h3 id="ofPublisher()">ofPublisher</h3> <pre data-language="java">public static HttpResponse.BodySubscriber&lt;Flow.Publisher&lt;List&lt;ByteBuffer&gt;&gt;&gt; ofPublisher()</pre> <div>
<p>Returns a response subscriber which publishes the response body through a <code>Publisher&lt;List&lt;ByteBuffer&gt;&gt;</code>. </p>
<p> The <a href="httpresponse"><code>HttpResponse</code></a> using this subscriber is available immediately after the response headers have been read, without requiring to wait for the entire body to be processed. The response body bytes can then be obtained by subscribing to the publisher returned by the <code>HttpResponse</code> <a href="httpresponse#body()"><code>body</code></a> method. </p>
<p>The publisher returned by the <a href="httpresponse#body()"><code>body</code></a> method can be subscribed to only once. The first subscriber will receive the body response bytes if successfully subscribed, or will cause the subscription to be cancelled otherwise. If more subscriptions are attempted, the subsequent subscribers will be immediately subscribed with an empty subscription and their <a href="../../../../java.base/java/util/concurrent/flow.subscriber#onError(java.lang.Throwable)"><code>onError</code></a> method will be invoked with an <code>IllegalStateException</code>.</p>
</div> <dl> <dt>API Note:</dt> <dd>To ensure that all resources associated with the corresponding exchange are properly released the caller must ensure that the provided publisher is subscribed once, and either <a href="../../../../java.base/java/util/concurrent/flow.subscription#request(long)">requests</a> all bytes until <a href="../../../../java.base/java/util/concurrent/flow.subscriber#onComplete()"><code>onComplete</code></a> or <a href="../../../../java.base/java/util/concurrent/flow.subscriber#onError(java.lang.Throwable)"><code>onError</code></a> are invoked, or cancel the provided <a href="../../../../java.base/java/util/concurrent/flow.subscriber#onSubscribe(java.util.concurrent.Flow.Subscription)">subscription</a> if it is unable or unwilling to do so. Note that depending on the actual HTTP protocol <a href="httpclient.version">version</a> used for the exchange, cancelling the subscription instead of exhausting the flow may cause the underlying HTTP connection to be closed and prevent it from being reused for subsequent operations.</dd> <dt>Returns:</dt> <dd>A <code>BodySubscriber</code> which publishes the response body through a <code>Publisher&lt;List&lt;ByteBuffer&gt;&gt;</code>.</dd> </dl>    <h3 id="replacing(java.lang.Object)">replacing</h3> <pre data-language="java">public static &lt;U&gt; HttpResponse.BodySubscriber&lt;U&gt; replacing(U value)</pre> <p>Returns a response subscriber which discards the response body. The supplied value is the value that will be returned from <a href="httpresponse#body()"><code>HttpResponse.body()</code></a>.</p> <dl> <dt>Type Parameters:</dt> <dd>
<code>U</code> - the type of the response body</dd> <dt>Parameters:</dt> <dd>
<code>value</code> - the value to return from HttpResponse.body(), may be <code>null</code>
</dd> <dt>Returns:</dt> <dd>a <code>BodySubscriber</code>
</dd> </dl>    <h3 id="discarding()">discarding</h3> <pre data-language="java">public static HttpResponse.BodySubscriber&lt;Void&gt; discarding()</pre> <p>Returns a response subscriber which discards the response body.</p> <dl> <dt>Returns:</dt> <dd>a response body subscriber</dd> </dl>    <h3 id="buffering(java.net.http.HttpResponse.BodySubscriber,int)">buffering</h3> <pre data-language="java">public static &lt;T&gt; HttpResponse.BodySubscriber&lt;T&gt; buffering(HttpResponse.BodySubscriber&lt;T&gt; downstream,
                                                           int bufferSize)</pre> <div>
<p>Returns a <code>BodySubscriber</code> which buffers data before delivering it to the given downstream subscriber. The subscriber guarantees to deliver <code>buffersize</code> bytes of data to each invocation of the downstream's <a href="../../../../java.base/java/util/concurrent/flow.subscriber#onNext(T)"><code>onNext</code></a> method, except for the final invocation, just before <a href="../../../../java.base/java/util/concurrent/flow.subscriber#onComplete()"><code>onComplete</code></a> is invoked. The final invocation of <code>onNext</code> may contain fewer than <code>bufferSize</code> bytes. </p>
<p> The returned subscriber delegates its <a href="httpresponse.bodysubscriber#getBody()"><code>getBody()</code></a> method to the downstream subscriber.</p>
</div> <dl> <dt>Type Parameters:</dt> <dd>
<code>T</code> - the type of the response body</dd> <dt>Parameters:</dt> <dd>
<code>downstream</code> - the downstream subscriber</dd> <dd>
<code>bufferSize</code> - the buffer size</dd> <dt>Returns:</dt> <dd>a buffering body subscriber</dd> <dt>Throws:</dt> <dd>
<code><a href="../../../../java.base/java/lang/illegalargumentexception">IllegalArgumentException</a></code> - if <code>bufferSize &lt;= 0</code>
</dd> </dl>    <h3 id="mapping(java.net.http.HttpResponse.BodySubscriber,java.util.function.Function)">mapping</h3> <pre data-language="java">public static &lt;T,U&gt; HttpResponse.BodySubscriber&lt;U&gt; mapping​(HttpResponse.BodySubscriber&lt;T&gt; upstream,
                                                                 Function&lt;? super T,​? extends U&gt; mapper)</pre> <div>
<p>Returns a <code>BodySubscriber</code> whose response body value is that of the result of applying the given function to the body object of the given <code>upstream</code> <code>BodySubscriber</code>. </p>
<p> The mapping function is executed using the client's <a href="httpclient#executor()">executor</a>, and can therefore be used to map any response body type, including blocking <a href="../../../../java.base/java/io/inputstream"><code>InputStream</code></a>, as shown in the following example which uses a well-known JSON parser to convert an <code>InputStream</code> into any annotated Java type. </p>
<p>For example: </p>
<pre data-language="java">public static &lt;W&gt; BodySubscriber&lt;W&gt; asJSON(Class&lt;W&gt; targetType) {
     BodySubscriber&lt;InputStream&gt; upstream = BodySubscribers.ofInputStream();

     BodySubscriber&lt;W&gt; downstream = BodySubscribers.mapping(
           upstream,
           (InputStream is) -&gt; {
               try (InputStream stream = is) {
                   ObjectMapper objectMapper = new ObjectMapper();
                   return objectMapper.readValue(stream, targetType);
               } catch (IOException e) {
                   throw new UncheckedIOException(e);
               }
           });
    return downstream;
 }</pre>
</div> <dl> <dt>Type Parameters:</dt> <dd>
<code>T</code> - the upstream body type</dd> <dd>
<code>U</code> - the type of the body subscriber returned</dd> <dt>Parameters:</dt> <dd>
<code>upstream</code> - the body subscriber to be mapped</dd> <dd>
<code>mapper</code> - the mapping function</dd> <dt>Returns:</dt> <dd>a mapping body subscriber</dd> </dl>   </section>  </div>  </main>  <div class="_attribution">
  <p class="_attribution-p">
    &copy; 1993, 2020, Oracle and/or its affiliates. All rights reserved.<br>Documentation extracted from Debian's OpenJDK Development Kit package.<br>Licensed under the GNU General Public License, version 2, with the Classpath Exception.<br>Various third party code in OpenJDK is licensed under different licenses (see Debian package).<br>Java and OpenJDK are trademarks or registered trademarks of Oracle and/or its affiliates.<br>
    <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.net.http/java/net/http/HttpResponse.BodySubscribers.html" class="_attribution-link">https://docs.oracle.com/en/java/javase/11/docs/api/java.net.http/java/net/http/HttpResponse.BodySubscribers.html</a>
  </p>
</div>
