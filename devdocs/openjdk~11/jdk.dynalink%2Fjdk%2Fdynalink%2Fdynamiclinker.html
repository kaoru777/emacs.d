  <main role="main">    <h1>Class DynamicLinker</h1>   <ul class="inheritance"> <li><a href="../../../java.base/java/lang/object">java.lang.Object</a></li> <li> <ul class="inheritance"> <li>jdk.dynalink.DynamicLinker</li> </ul> </li> </ul>    <pre data-language="java">public final class DynamicLinker
extends Object</pre> <div>
<p>The linker for <a href="relinkablecallsite"><code>RelinkableCallSite</code></a> objects. A dynamic linker is a main objects when using Dynalink, it coordinates linking of call sites with linkers of available language runtimes that are represented by <a href="linker/guardingdynamiclinker"><code>GuardingDynamicLinker</code></a> objects (you only need to deal with these if you are yourself implementing a language runtime with its own object model and/or type conversions). To use Dynalink, you have to create one or more dynamic linkers using a <a href="dynamiclinkerfactory"><code>DynamicLinkerFactory</code></a>. Subsequently, you need to invoke its <a href="#link(T)"><code>link(RelinkableCallSite)</code></a> method from <code>invokedynamic</code> bootstrap methods to let it manage all the call sites they create. Usual usage would be to create at least one class per language runtime to contain one linker instance as: <pre data-language="java">class MyLanguageRuntime {
     private static final GuardingDynamicLinker myLanguageLinker = new MyLanguageLinker();
     private static final DynamicLinker dynamicLinker = createDynamicLinker();

     private static DynamicLinker createDynamicLinker() {
         final DynamicLinkerFactory factory = new DynamicLinkerFactory();
         factory.setPrioritizedLinker(myLanguageLinker);
         return factory.createLinker();
     }

     public static CallSite bootstrap(MethodHandles.Lookup lookup, String name, MethodType type) {
         return dynamicLinker.link(
             new SimpleRelinkableCallSite(
                 new CallSiteDescriptor(lookup, parseOperation(name), type)));
     }

     private static Operation parseOperation(String name) {
         ...
     }
 }</pre> The above setup of one static linker instance is often too simple. You will often have your language runtime have a concept of some kind of "context class loader" and you will want to create one dynamic linker per such class loader, to ensure it incorporates linkers for all other language runtimes visible to that class loader (see <a href="dynamiclinkerfactory#setClassLoader(java.lang.ClassLoader)"><code>DynamicLinkerFactory.setClassLoader(ClassLoader)</code></a>). </p>
<p> There are three components you need to provide in the above example: </p>
<ul> <li>You are expected to provide a <a href="linker/guardingdynamiclinker"><code>GuardingDynamicLinker</code></a> for your own language. If your runtime doesn't have its own object model or type conversions, you don't need to implement a <code>GuardingDynamicLinker</code>; you would simply not invoke the <code>setPrioritizedLinker</code> method on the factory.</li> <li>The performance of the programs can depend on your choice of the class to represent call sites. The above example used <a href="support/simplerelinkablecallsite"><code>SimpleRelinkableCallSite</code></a>, but you might want to use <a href="support/chainedcallsite"><code>ChainedCallSite</code></a> instead. You'll need to experiment and decide what fits your runtime the best. You can further subclass either of these or implement your own.</li> <li>You also need to provide <a href="callsitedescriptor"><code>CallSiteDescriptor</code></a>s to your call sites. They are immutable objects that contain all the information about the call site: the class performing the lookups, the operation being invoked, and the method signature. You will have to supply your own scheme to encode and decode operations in the call site name or static parameters, that is why in the above example the <code>parseOperation</code> method is left unimplemented.</li> </ul>
</div>      <section role="region">  <h2 id="method.summary">Methods</h2> <table>  <tr> <th scope="col">Modifier and Type</th> <th scope="col">Method</th> <th scope="col">Description</th> </tr> <tr id="i0"> <td><code>static <a href="../../../java.base/java/lang/stacktraceelement">StackTraceElement</a></code></td> <th scope="row"><code><a href="#getLinkedCallSiteLocation()">getLinkedCallSiteLocation</a>()</code></th> <td> <p>Returns a stack trace element describing the location of the <code>invokedynamic</code> call site currently being linked on the current thread.</p> </td> </tr> <tr id="i1"> <td><code><a href="linker/linkerservices">LinkerServices</a></code></td> <th scope="row"><code><a href="#getLinkerServices()">getLinkerServices</a>()</code></th> <td> <p>Returns the object representing the linker services of this class that are normally exposed to individual <a href="linker/guardingdynamiclinker"><code>language-specific linkers</code></a>.</p> </td> </tr> <tr id="i2"> <td><code>&lt;T extends <a href="relinkablecallsite">RelinkableCallSite</a>&gt;<br>T</code></td> <th scope="row"><code><a href="#link(T)">link</a>​(T callSite)</code></th> <td> <p>Links an invokedynamic call site.</p> </td> </tr> </table>  <h2 id="methods.inherited.from.class.java.lang.Object">Methods declared in class java.lang.<a href="../../../java.base/java/lang/object">Object</a>
</h2> <code><a href="../../../java.base/java/lang/object#clone()">clone</a>, <a href="../../../java.base/java/lang/object#equals(java.lang.Object)">equals</a>, <a href="../../../java.base/java/lang/object#finalize()">finalize</a>, <a href="../../../java.base/java/lang/object#getClass()">getClass</a>, <a href="../../../java.base/java/lang/object#hashCode()">hashCode</a>, <a href="../../../java.base/java/lang/object#notify()">notify</a>, <a href="../../../java.base/java/lang/object#notifyAll()">notifyAll</a>, <a href="../../../java.base/java/lang/object#toString()">toString</a>, <a href="../../../java.base/java/lang/object#wait()">wait</a>, <a href="../../../java.base/java/lang/object#wait(long)">wait</a>, <a href="../../../java.base/java/lang/object#wait(long,int)">wait</a></code>  </section>   <div>   <section role="region">  <h2 id="method.detail">Methods</h2>   <h3 id="link(jdk.dynalink.RelinkableCallSite)">link</h3> <pre data-language="java">public &lt;T extends RelinkableCallSite&gt; T link(T callSite)</pre> <p>Links an invokedynamic call site. It will install a method handle into the call site that invokes the relinking mechanism of this linker. Next time the call site is invoked, it will be linked for the actual arguments it was invoked with.</p> <dl> <dt>Type Parameters:</dt> <dd>
<code>T</code> - the particular subclass of <a href="relinkablecallsite"><code>RelinkableCallSite</code></a> for which to create a link.</dd> <dt>Parameters:</dt> <dd>
<code>callSite</code> - the call site to link.</dd> <dt>Returns:</dt> <dd>the callSite, for easy call chaining.</dd> </dl>    <h3 id="getLinkerServices()">getLinkerServices</h3> <pre data-language="java">public LinkerServices getLinkerServices()</pre> <p>Returns the object representing the linker services of this class that are normally exposed to individual <a href="linker/guardingdynamiclinker"><code>language-specific linkers</code></a>. While as a user of this class you normally only care about the <a href="#link(T)"><code>link(RelinkableCallSite)</code></a> method, in certain circumstances you might want to use the lower level services directly; either to lookup specific method handles, to access the type converters, and so on.</p> <dl> <dt>Returns:</dt> <dd>the object representing the linker services of this class.</dd> </dl>    <h3 id="getLinkedCallSiteLocation()">getLinkedCallSiteLocation</h3> <pre data-language="java">public static StackTraceElement getLinkedCallSiteLocation()</pre> <p>Returns a stack trace element describing the location of the <code>invokedynamic</code> call site currently being linked on the current thread. The operation is potentially expensive as it needs to generate a stack trace to inspect it and is intended for use in diagnostics code. For "free-floating" call sites (not associated with an <code>invokedynamic</code> instruction), the result is not well-defined.</p> <dl> <dt>Returns:</dt> <dd>a stack trace element describing the location of the call site currently being linked, or null if it is not invoked while a call site is being linked.</dd> </dl>   </section>  </div>  </main>  <div class="_attribution">
  <p class="_attribution-p">
    &copy; 1993, 2020, Oracle and/or its affiliates. All rights reserved.<br>Documentation extracted from Debian's OpenJDK Development Kit package.<br>Licensed under the GNU General Public License, version 2, with the Classpath Exception.<br>Various third party code in OpenJDK is licensed under different licenses (see Debian package).<br>Java and OpenJDK are trademarks or registered trademarks of Oracle and/or its affiliates.<br>
    <a href="https://docs.oracle.com/en/java/javase/11/docs/api/jdk.dynalink/jdk/dynalink/DynamicLinker.html" class="_attribution-link">https://docs.oracle.com/en/java/javase/11/docs/api/jdk.dynalink/jdk/dynalink/DynamicLinker.html</a>
  </p>
</div>
