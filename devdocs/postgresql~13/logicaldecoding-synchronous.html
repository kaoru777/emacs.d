<h1>48.8. Synchronous Replication Support for Logical Decoding</h1>    <div class="toc"> <dl class="toc"> <dt><a href="logicaldecoding-synchronous#id-1.8.14.14.2">48.8.1. Overview</a></dt> <dt><a href="logicaldecoding-synchronous#LOGICALDECODING-SYNCHRONOUS-CAVEATS">48.8.2. Caveats</a></dt> </dl> </div> <div class="sect2" id="id-1.8.14.14.2">    <h2 class="title">48.8.1. Overview</h2>    <p>Logical decoding can be used to build <a class="link" href="warm-standby#SYNCHRONOUS-REPLICATION" title="26.2.8. Synchronous Replication">synchronous replication</a> solutions with the same user interface as synchronous replication for <a class="link" href="warm-standby#STREAMING-REPLICATION" title="26.2.5. Streaming Replication">streaming replication</a>. To do this, the streaming replication interface (see <a class="xref" href="https://www.postgresql.org/docs/13/logicaldecoding-walsender.html" title="48.3. Streaming Replication Protocol Interface">Section 48.3</a>) must be used to stream out data. Clients have to send <code class="literal">Standby status update (F)</code> (see <a class="xref" href="https://www.postgresql.org/docs/13/protocol-replication.html" title="52.4. Streaming Replication Protocol">Section 52.4</a>) messages, just like streaming replication clients do.</p> <blockquote class="note"> <h3 class="title">Note</h3> <p>A synchronous replica receiving changes via logical decoding will work in the scope of a single database. Since, in contrast to that, <em class="parameter"><code>synchronous_standby_names</code></em> currently is server wide, this means this technique will not work properly if more than one database is actively used.</p> </blockquote> </div> <div class="sect2" id="LOGICALDECODING-SYNCHRONOUS-CAVEATS">    <h2 class="title">48.8.2. Caveats</h2>    <p>In synchronous replication setup, a deadlock can happen, if the transaction has locked [user] catalog tables exclusively. See <a class="xref" href="https://www.postgresql.org/docs/13/logicaldecoding-output-plugin.html#LOGICALDECODING-CAPABILITIES" title="48.6.2. Capabilities">Section 48.6.2</a> for information on user catalog tables. This is because logical decoding of transactions can lock catalog tables to access them. To avoid this users must refrain from taking an exclusive lock on [user] catalog tables. This can happen in the following ways:</p>  <ul> <li> <p>Issuing an explicit <code class="command">LOCK</code> on <code class="structname">pg_class</code> in a transaction.</p> </li> <li> <p>Perform <code class="command">CLUSTER</code> on <code class="structname">pg_class</code> in a transaction.</p> </li> <li> <p>Executing <code class="command">TRUNCATE</code> on [user] catalog table in a transaction.</p> </li> </ul>  <p>Note that these commands that can cause deadlock apply to not only explicitly indicated system catalog tables above but also to any other [user] catalog table.</p> </div>  <div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navfooter">  <table summary="Navigation footer"> <tr> <td width="40%" align="left">
<a accesskey="p" href="https://www.postgresql.org/docs/13/logicaldecoding-writer.html" title="48.7. Logical Decoding Output Writers">Prev</a> </td> <td width="20%" align="center"><a accesskey="u" href="https://www.postgresql.org/docs/13/logicaldecoding.html" title="Chapter 48. Logical Decoding">Up</a></td> <td width="40%" align="right"> <a accesskey="n" href="https://www.postgresql.org/docs/13/replication-origins.html" title="Chapter 49. Replication Progress Tracking">Next</a>
</td> </tr> <tr> <td width="40%" align="left">48.7. Logical Decoding Output Writers </td> <td width="20%" align="center"><a accesskey="h" href="https://www.postgresql.org/docs/13/index.html" title="PostgreSQL 13.4 Documentation">Home</a></td> <td width="40%" align="right"> Chapter 49. Replication Progress Tracking</td> </tr> </table> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 1996&ndash;2021 The PostgreSQL Global Development Group<br>Licensed under the PostgreSQL License.<br>
    <a href="https://www.postgresql.org/docs/13/logicaldecoding-synchronous.html" class="_attribution-link">https://www.postgresql.org/docs/13/logicaldecoding-synchronous.html</a>
  </p>
</div>
